<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Notify your friends</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="/styles.css" />
    <link
      href="https://fonts.googleapis.com/css?family=Maven+Pro|Yrsa|Press+Start+2P"
      rel="stylesheet"
    />
    <meta name="theme-color" content="#fafafa" />
  </head>

  <body>
    <p class="successMsg" role="alert" hidden>Messages sent...</p>
    <p class="errorMsg" role="alert" hidden>Something went wrong...</p>
    <form name="contact" class="form" method="POST" data-netlify="true">
      <button class="btn" type="submit">Send messages!</button>
    </form>

    <script>
      const form = document.querySelector('form');
      form.addEventListener('submit', async event => {
        event.preventDefault();
        try {
          const response = await fetch('/', {
            method: 'post',
            headers: {
              'Content-type': 'application/x-www-form-urlencoded; charset=UTF-8'
            },
            body: new URLSearchParams(new FormData(form)).toString()
          });

          form.querySelector('button').disabled = true;

          if (response.status === 200) {
            document.querySelector('.successMsg').hidden = false;
          } else {
            document.querySelector('.errorMsg').hidden = false;
          }
        } catch (e) {
          console.error(e);
        }
      });
    </script>
  </body>
</html>
